<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.0.0">Jekyll</generator><link href="https://piyush.dev/feed.xml" rel="self" type="application/atom+xml" /><link href="https://piyush.dev/" rel="alternate" type="text/html" /><updated>2021-07-08T04:21:19-05:00</updated><id>https://piyush.dev/feed.xml</id><title type="html">Piyush Jain</title><subtitle>Data Scientist |  Engineer | Entrepreneur</subtitle><entry><title type="html">Random Convolutional Kernel Transform</title><link href="https://piyush.dev/research-paper/time-series/classification/2020/07/24/Random-convolutional-kernel-transform.html" rel="alternate" type="text/html" title="Random Convolutional Kernel Transform" /><published>2020-07-24T00:00:00-05:00</published><updated>2020-07-24T00:00:00-05:00</updated><id>https://piyush.dev/research-paper/time-series/classification/2020/07/24/Random-convolutional-kernel-transform</id><content type="html" xml:base="https://piyush.dev/research-paper/time-series/classification/2020/07/24/Random-convolutional-kernel-transform.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-07-24-Random-convolutional-kernel-transform.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Introduction&quot;&gt;Introduction&lt;a class=&quot;anchor-link&quot; href=&quot;#Introduction&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;&lt;em&gt;ROCKET: Exceptionally fast and accurate time series classification using random convolutional kernels&lt;/em&gt;&lt;/strong&gt;  is a research paper published in October 2019 by Angus Dempster, François Petitjean, Geoffrey I. Webb. The paper presents a unique methodology to transform time series data using convolutional kernels to improve classification accuracy. This paper is unique in learning from the recent success of convolutional neural networks and transferring it on time-series datasets.&lt;/p&gt;
&lt;p&gt;The link to download the paper from arxiv - &lt;a href=&quot;https://arxiv.org/pdf/1910.13051&quot;&gt;Paper&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;Time-Series-data&quot;&gt;Time Series data&lt;a class=&quot;anchor-link&quot; href=&quot;#Time-Series-data&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Time series data is defined as a set of data points containing details about different points in time. Generally, time-series data contains data points sampled/observed at an equal interval of time. Time series classification is task of identifying patterns and signals in the data in relation to respective classes.&lt;/p&gt;
&lt;p&gt;The proposal is features generated by the convolution of randomly generated kernels on time series data results in faster and better time series classifiers. We will go into more detail of this proposal and understand how the methodology proposed by them helps to improve the accuracy.&lt;/p&gt;
&lt;h2 id=&quot;Kernels&quot;&gt;Kernels&lt;a class=&quot;anchor-link&quot; href=&quot;#Kernels&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Kernels in simple terms is a small matrix used to modify the images. Let's try to understand kernels using an example:&lt;/p&gt;
&lt;p&gt;here is a 3 x 3 kernel used to sharpen images:&lt;/p&gt;
&lt;p&gt;$\begin{bmatrix} 0 &amp;amp; -1 &amp;amp; 0 \\ -1 &amp;amp; 5 &amp;amp; -1 \\ 0 &amp;amp; -1 &amp;amp; 0  \end{bmatrix}$&lt;/p&gt;
&lt;p&gt;To sharpen an image using the above kernel, we need to perform a dot product of each pixel in the image with the kernel matrix. The resulting image would then be a sharpened version of the original image. Observe the gif below to see a live version of the kernel dot product in motion.&lt;/p&gt;
&lt;p&gt;Following is an example from setosa.io site to demonstrate how kernels can be used to make desirable changes to an image.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/copied_from_nb/images/setosa-kernel-image.png&quot; alt=&quot;&quot; title=&quot;credit: setosa.io/ev/image-kernels/&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;5-parameters-of-kernels&quot;&gt;5 parameters of kernels&lt;a class=&quot;anchor-link&quot; href=&quot;#5-parameters-of-kernels&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;A kernel has 5 different parameter using which it can be configured.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;&lt;tr&gt;
&lt;th&gt;Parameter&lt;/th&gt;
&lt;th&gt;Description&lt;/th&gt;
&lt;th&gt;Value logic&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Bias&lt;/td&gt;
&lt;td&gt;Bias is added to the result of the convolution operation between input time series and weights of the given kernel&lt;/td&gt;
&lt;td&gt;Bias is sampled from a uniform distribution, b ∼ U(−1,1)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Size(Length)&lt;/td&gt;
&lt;td&gt;Size defines the number of rows and columns a kernel has. The above example has a size of 3 rows and 3 columns&lt;/td&gt;
&lt;td&gt;Length is selected randomly from {7,9,11} with equal probability, making kernels considerably shorter than input time series in most cases&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Weights&lt;/td&gt;
&lt;td&gt;The values that make up the kernel matrix are weights&lt;/td&gt;
&lt;td&gt;The weights are sampled from a normal distribution, ∀w ∈ W, w ∼ N(0,1), and are mean-centered after being set, ω = W − W. As such, most weights are relatively small, but can take on larger magnitudes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Dilation&lt;/td&gt;
&lt;td&gt;Dilation spreads a kernel over the input such that with dilation of value two, weights in a kernel are convolved with every second element of input time series&lt;/td&gt;
&lt;td&gt;Dilation is sampled on an exponential scale d = ⌊2x⌋,x ∼ U(0,A), input −1 where A = log2 kernel −1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Padding&lt;/td&gt;
&lt;td&gt;Padding involves appending values(typically zero) to the start and end of input time series such that the middleweight of a kernel aligns with the first value of input time series at the start of convolution&lt;/td&gt;
&lt;td&gt;When each kernel is generated, a decision is made (at random, with equal probability) whether or not padding will be used when applying the kernel&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&quot;Features-generated-by-Rocket-kernel&quot;&gt;Features generated by Rocket kernel&lt;a class=&quot;anchor-link&quot; href=&quot;#Features-generated-by-Rocket-kernel&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Rocket computes two aggregate features from each kernel and feature convolution. The two features are created using the well-known methodology global/average max pooling and a unique methodology positive proportion value (ppv).&lt;/p&gt;
&lt;h3 id=&quot;Max-pooling&quot;&gt;Max-pooling&lt;a class=&quot;anchor-link&quot; href=&quot;#Max-pooling&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Global max-pooling is essentially picking the maximum value from the result of convolution and max pooling is picking the maximum value within a pool size. 
Assuming that the output of convolution is 0,1,2,2,5,1,2, global max pooling outputs 5, whereas ordinary max pooling  with pool size equals to 3 outputs 2,2,5,5,5&lt;/p&gt;
&lt;h3 id=&quot;Proportion-of-positive-values&quot;&gt;Proportion of positive values&lt;a class=&quot;anchor-link&quot; href=&quot;#Proportion-of-positive-values&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Let's try to understand using the author's own words to describe ppv.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;ppv directly captures the proportion of the input which matches a given pattern, i.e., for which the output of the convolution operation is positive. The ppv works in conjunction with the bias term. The bias term acts as a kind of ‘threshold’ for ppv. A positive bias value means that ppv captures the proportion of the input reflecting even ‘weak’ matches between the input and a given pattern, while a negative bias value means that ppv only captures the proportion of the input reflecting ‘strong’ matches between the input and the given pattern.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;Rocket-usage&quot;&gt;Rocket usage&lt;a class=&quot;anchor-link&quot; href=&quot;#Rocket-usage&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Now that we understand what kernels are and how rocket generates two outputs by convolution of kernel and input vector, let's understand how to use it.&lt;/p&gt;
&lt;p&gt;The time-series data needs to be provided as input into the rocket transform method, the value for the number of kernels (i.e. k) is set at 10,000 by default. This means that for each one of the input features we get 20,000 features as output from rocket transform.&lt;/p&gt;
&lt;p&gt;The transformed feature table can now we used as input data for any classification algorithm, authors advise linear algorithms like ridge regression classifier or logistic regression.&lt;/p&gt;
&lt;h2 id=&quot;Rocket-v/s-others&quot;&gt;Rocket v/s others&lt;a class=&quot;anchor-link&quot; href=&quot;#Rocket-v/s-others&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Rocket's approach of creating a large number of random kernels and generating two features from each kernel is unique. Rocket distinguishes itself based on various other factors which we will discuss below.&lt;/p&gt;
&lt;h3 id=&quot;Rocket-v/s-neural-nets&quot;&gt;Rocket v/s neural nets&lt;a class=&quot;anchor-link&quot; href=&quot;#Rocket-v/s-neural-nets&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;Rocket doesn’t use a hidden layer or any non-linearities&lt;/li&gt;
&lt;li&gt;Features produced by Rocket are independent of each other&lt;/li&gt;
&lt;li&gt;Rocket works with any kind of classifier&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;Rocket-v/s-CNN&quot;&gt;Rocket v/s CNN&lt;a class=&quot;anchor-link&quot; href=&quot;#Rocket-v/s-CNN&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;Rocket uses a very large number of kernels&lt;/li&gt;
&lt;li&gt;In CNN, a group of kernels tend to share the same size, dilation and padding. Rocket has all 5 parameters randomized.&lt;/li&gt;
&lt;li&gt;In CNN, Dilation increases exponentially with depth; Rocket has random dilation values&lt;/li&gt;
&lt;li&gt;CNNs only have average/max pooling. Rocket has a unique pooling called as ppv which has proven to provide much better classification accuracy on time series. &lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;Rocket-performance&quot;&gt;Rocket performance&lt;a class=&quot;anchor-link&quot; href=&quot;#Rocket-performance&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;The authors provide detailed information about the classification accuracy and time taken to train the model. I am discussing the results from bakeoff datasets in this article and you will be able to find results from various additional datasets in the paper.&lt;/p&gt;
&lt;h3 id=&quot;Accuracy&quot;&gt;Accuracy&lt;a class=&quot;anchor-link&quot; href=&quot;#Accuracy&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Rank is calculated by taking a mean value of classification accuracy across all the 85 datasets in bakeoff datasets.&lt;/p&gt;
&lt;p&gt;It is clear that the model trained using features derived using rocket is faring better compared to other models on average among all the datasets in bake-off datasets. Please note that the dark horizontal line connecting the rank position of two models depict that the results from two models are not statistically insignificant.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://github.com/jainds/practical-ai/blob/master/_notebooks/images/Rocket-mean-acuracy-on-bakeoff-datasets.png?raw=1&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;Time-taken-to-train&quot;&gt;Time taken to train&lt;a class=&quot;anchor-link&quot; href=&quot;#Time-taken-to-train&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;&lt;tr&gt;
&lt;th&gt;Architecture&lt;/th&gt;
&lt;th&gt;Largest dataset(ElectricDevices, with 8,926 training examples)&lt;/th&gt;
&lt;th&gt;Longest time series(HandOutlines, with time series of length 2,709)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;ROCKET&lt;/td&gt;
&lt;td&gt;6 minutes 33 seconds&lt;/td&gt;
&lt;td&gt;4 minutes 18 seconds&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;MrSEQL&lt;/td&gt;
&lt;td&gt;31 minutes&lt;/td&gt;
&lt;td&gt;1 hour 55 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;cBOSS&lt;/td&gt;
&lt;td&gt;3 hours 6 minutes&lt;/td&gt;
&lt;td&gt;42 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Proximity Forest&lt;/td&gt;
&lt;td&gt;1 hour 35 minutes&lt;/td&gt;
&lt;td&gt;3 days&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;TS-CHIEF&lt;/td&gt;
&lt;td&gt;2 hours 24 minutes&lt;/td&gt;
&lt;td&gt;4 days&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Inception Time (on GPU)&lt;/td&gt;
&lt;td&gt;7 hours 46 minutes&lt;/td&gt;
&lt;td&gt;8 hours 10 minutes&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&quot;Example&quot;&gt;Example&lt;a class=&quot;anchor-link&quot; href=&quot;#Example&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;In the below examples, we are going to try and train a Human activity recognizer time series classifier.
I am using two nice repo by Guillaume Chevalier showcasing &lt;a href=&quot;https://github.com/jainds/LSTM-Human-Activity-Recognition&quot;&gt;LSTM model on Human activity recognizer&lt;/a&gt; with a classification accuracy of 91% and by &lt;a href=&quot;https://github.com/thanatchon36/Rocket_vs_LSTM-Human-Activity-Recognition&quot;&gt;Thanatchon&lt;/a&gt; . Let's see how much accuracy can be achieved by using rocket transforms.&lt;/p&gt;
&lt;p&gt;We will be using sktime implementation of rocket in this example&lt;/p&gt;
&lt;h3 id=&quot;Install-libraries-&amp;amp;-import-Statements&quot;&gt;Install libraries &amp;amp; import Statements&lt;a class=&quot;anchor-link&quot; href=&quot;#Install-libraries-&amp;amp;-import-Statements&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-hide&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandas&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pd&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;IPython.core.interactiveshell&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;InteractiveShell&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;InteractiveShell&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ast_node_interactivity&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;all&amp;quot;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;os&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;zipfile&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#orchestration&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.pipeline&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;make_pipeline&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;#transforms&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sktime.transformers.series_as_features.rocket&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Rocket&lt;/span&gt; 

&lt;span class=&quot;c1&quot;&gt;#plot&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;#metrics&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.metrics&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;classification_report&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.metrics&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;confusion_matrix&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.metrics&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plot_confusion_matrix&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Classifier&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.linear_model&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RidgeClassifierCV&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Download-dataset-and-extract&quot;&gt;Download dataset and extract&lt;a class=&quot;anchor-link&quot; href=&quot;#Download-dataset-and-extract&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-hide&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Download the file&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;wget &lt;span class=&quot;s2&quot;&gt;&amp;quot;https://archive.ics.uci.edu/ml/machine-learning-databases/00240/UCI HAR Dataset.zip&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;--2020-07-24 06:58:35--  https://archive.ics.uci.edu/ml/machine-learning-databases/00240/UCI%20HAR%20Dataset.zip
Resolving archive.ics.uci.edu (archive.ics.uci.edu)... 128.195.10.252
Connecting to archive.ics.uci.edu (archive.ics.uci.edu)|128.195.10.252|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 60999314 (58M) [application/x-httpd-php]
Saving to: ‘UCI HAR Dataset.zip’

UCI HAR Dataset.zip 100%[===================&amp;gt;]  58.17M  35.0MB/s    in 1.7s    

2020-07-24 06:58:37 (35.0 MB/s) - ‘UCI HAR Dataset.zip’ saved [60999314/60999314]

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-hide&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Extract&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;zip_ref&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;zipfile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ZipFile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;UCI HAR Dataset.zip&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;zip_ref&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;extractall&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;./&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;zip_ref&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-hide&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# validate if file exists&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;ls ./&lt;span class=&quot;s1&quot;&gt;&amp;#39;UCI HAR Dataset&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;activity_labels.txt  features_info.txt	features.txt  README.txt  test	train
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-hide&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Useful Constants&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Those are separate normalised input features for the neural network&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;INPUT_SIGNAL_TYPES&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;body_acc_x_&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;body_acc_y_&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;body_acc_z_&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;body_gyro_x_&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;body_gyro_y_&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;body_gyro_z_&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;total_acc_x_&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;total_acc_y_&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;total_acc_z_&amp;quot;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Output classes to learn how to classify&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;LABELS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;WALKING&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;WALKING_UPSTAIRS&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;WALKING_DOWNSTAIRS&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;SITTING&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;STANDING&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;LAYING&amp;quot;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Defining-Train-test-data&quot;&gt;Defining Train test data&lt;a class=&quot;anchor-link&quot; href=&quot;#Defining-Train-test-data&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;DATA_PATH&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;./&amp;quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;TRAIN&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;train/&amp;quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;TEST&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;test/&amp;quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;DATASET_PATH&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DATA_PATH&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;UCI HAR Dataset/&amp;quot;&lt;/span&gt;


&lt;span class=&quot;c1&quot;&gt;# Load &amp;quot;X&amp;quot; (the neural network&amp;#39;s training and testing inputs)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;load_X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_signals_paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;X_signals&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;signal_type_path&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_signals_paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;signal_type_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Read dataset from disk, dealing with text files&amp;#39; syntax&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;X_signals&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;serie&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;serie&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;  &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;row&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;file&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transpose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_signals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;X_train_signals_paths&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;DATASET_PATH&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TRAIN&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Inertial Signals/&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;signal&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;train.txt&amp;quot;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;signal&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;INPUT_SIGNAL_TYPES&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X_test_signals_paths&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;DATASET_PATH&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TEST&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Inertial Signals/&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;signal&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;test.txt&amp;quot;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;signal&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;INPUT_SIGNAL_TYPES&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;load_X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_train_signals_paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;load_X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_test_signals_paths&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;c1&quot;&gt;# Load &amp;quot;y&amp;quot; (the neural network&amp;#39;s training and testing outputs)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;load_y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Read dataset from disk, dealing with text file&amp;#39;s syntax&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;y_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;elem&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;elem&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;row&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;  &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;row&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;file&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt; 
        &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int32&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# Substract 1 to each output class for friendly 0-based indexing &lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;y_train_path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DATASET_PATH&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TRAIN&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;y_train.txt&amp;quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y_test_path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DATASET_PATH&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TEST&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;y_test.txt&amp;quot;&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;load_y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_train_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;load_y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_test_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;OK !&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;OK !
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Preparing-dataset&quot;&gt;Preparing dataset&lt;a class=&quot;anchor-link&quot; href=&quot;#Preparing-dataset&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;preprocess_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;dim_dict&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;name_i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;dim_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;dim_dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name_i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data_array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data_array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;name_dim&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;dim_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;dim_dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data_array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;float64&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
            
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dim_dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;OK !&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;OK !
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;details class=&quot;description&quot; open=&quot;&quot;&gt;
      &lt;summary class=&quot;btn btn-sm&quot; data-open=&quot;Hide Code&quot; data-close=&quot;Show Code&quot;&gt;&lt;/summary&gt;
        &lt;p&gt;&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#collapse-show&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;128&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;128&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;time&lt;/span&gt; X_train = preprocess_data(X_train)
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;time&lt;/span&gt; X_test = preprocess_data(X_test)

&lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;copy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ravel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;copy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ravel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;each&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;each&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;each&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;each&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/p&gt;
    &lt;/details&gt;
&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;CPU times: user 15.6 s, sys: 382 ms, total: 16 s
Wall time: 15.5 s
CPU times: user 6.62 s, sys: 282 ms, total: 6.9 s
Wall time: 6.47 s
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Rocket-Model&quot;&gt;Rocket Model&lt;a class=&quot;anchor-link&quot; href=&quot;#Rocket-Model&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rocket_pipeline&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;make_pipeline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;Rocket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_kernels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random_state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;RidgeClassifierCV&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;alphas&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;logspace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;normalize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;time&lt;/span&gt; rocket_pipeline.fit(X_train, y_train)
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;CPU times: user 15min 33s, sys: 8.24 s, total: 15min 41s
Wall time: 8min 4s
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;Pipeline(memory=None,
         steps=[(&amp;#39;rocket&amp;#39;,
                 Rocket(normalise=True, num_kernels=10000, random_state=1)),
                (&amp;#39;ridgeclassifiercv&amp;#39;,
                 RidgeClassifierCV(alphas=array([1.00000000e-03, 4.64158883e-03, 2.15443469e-02, 1.00000000e-01,
       4.64158883e-01, 2.15443469e+00, 1.00000000e+01, 4.64158883e+01,
       2.15443469e+02, 1.00000000e+03]),
                                   class_weight=None, cv=None,
                                   fit_intercept=True, normalize=True,
                                   scoring=None, store_cv_values=False))],
         verbose=False)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Accuracy&quot;&gt;Accuracy&lt;a class=&quot;anchor-link&quot; href=&quot;#Accuracy&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;time&lt;/span&gt; rocket_pipeline.score(X_test, y_test)
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;CPU times: user 4min 32s, sys: 193 ms, total: 4min 32s
Wall time: 2min 17s
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;0.9355276552426196&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;time&lt;/span&gt; y_pred = list(rocket_pipeline.predict(X_test))
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;CPU times: user 4min 32s, sys: 128 ms, total: 4min 32s
Wall time: 2min 17s
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;time&lt;/span&gt; plot_confusion_matrix(rocket_pipeline, X_test, y_test, display_labels = LABELS)
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;CPU times: user 4min 32s, sys: 247 ms, total: 4min 32s
Wall time: 2min 18s
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;&amp;lt;sklearn.metrics._plot.confusion_matrix.ConfusionMatrixDisplay at 0x7f49fc711cf8&amp;gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Conclusion&quot;&gt;Conclusion&lt;a class=&quot;anchor-link&quot; href=&quot;#Conclusion&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;We were able to improve upon accuracy achieved by LSTM model by a very simple implementation using Rocket. LSTM had scored 91% and using Rocket + Ridge Regression classifier the accuracy jumped to 93%. The performance gain achieved becomes sweeter when you compare the time required to code and train, which was very small compared for rocket in comparison to LSTM in our case. 
The Rocket methodology is an innovative, simple and fresh technique that attracted my attention to this research paper.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://piyush.dev/images/Rocket-mean-acuracy-on-bakeoff-datasets.png" /><media:content medium="image" url="https://piyush.dev/images/Rocket-mean-acuracy-on-bakeoff-datasets.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">All you need to know about CVAT</title><link href="https://piyush.dev/annotation/2020/07/11/CVAT-All-you-need-to-know.html" rel="alternate" type="text/html" title="All you need to know about CVAT" /><published>2020-07-11T00:00:00-05:00</published><updated>2020-07-11T00:00:00-05:00</updated><id>https://piyush.dev/annotation/2020/07/11/CVAT-All-you-need-to-know</id><content type="html" xml:base="https://piyush.dev/annotation/2020/07/11/CVAT-All-you-need-to-know.html">&lt;h2 id=&quot;introduction&quot;&gt;Introduction&lt;/h2&gt;

&lt;p&gt;Once you start your journey into data science, you quickly learn that as part of your job you are spending more time with data than models. Data and labels go hand in hand and hence, I will be sharing what you need to know before you decide to use &lt;a href=&quot;https://cvat.org&quot;&gt;CVAT&lt;/a&gt; as your image/video annotation tool. Let’s start with the easier bit i.e. complete name of tool - Computer Vision Annotation Tool&lt;/p&gt;

&lt;h2 id=&quot;ease-of-setup&quot;&gt;Ease of Setup&lt;/h2&gt;

&lt;p&gt;A treat awaits in this section if you have worked with &lt;a href=&quot;https://docs.docker.com/compose/&quot;&gt;docker compose&lt;/a&gt; before, CVAT is very easy to setup as the source code contains necessary docker compose files which makes complete setup a breeze in your local. Repo also features an instruction documentation which is comprehensively written and covers every line of code that needs to be executed in order to get the tool running.&lt;/p&gt;

&lt;p&gt;Complete setup is nicely segregated into docker-compose files with docker apps named cvat,cvat_ui, cvat_db. 
There are two ways to go ahead with setting up the tool, the easier way of deploying it in a VM and a little longer way on Kubernetes. A VM with enough firepower to run an instance of Postgres, Django backend and a react app to support the number of users that you expect to access the tool simultaneously should be alright. An example: I was able to support 200+ users(some of them were automated scripts) in a single VM with the analytics component running using a Standard D5 v2 (16 vcpus, 56 GiB memory) Azure VM. The power of your VM needs to be proportionately increased if you wish to use the additional components like deep learning model based auto labelling. 
If you choose to deploy the tool in Kubernetes, you could benefit from the auto-scaling functionality for each app inside CVAT. Kubernetes YAML files are not available as part of source code and hence you might need to create them yourself. I recommend &lt;a href=&quot;https://kompose.io&quot;&gt;Kompose&lt;/a&gt; to create Kubrnetes YAML from docker compose files. Scalability is an important aspect while considering a tool for production deployment. In order to make sure that the tool works for foreseeable growth in number of users. App can be scaled easily since everything is nicely wrapped into docker containers.&lt;/p&gt;

&lt;h2 id=&quot;ease-of-usage&quot;&gt;Ease of Usage&lt;/h2&gt;

&lt;p&gt;The application’s desktop UI although not fancy, is very feature rich and achieves the goal of labeling images and videos with ease.There’s a long list of keyboard shortcuts supported and you don’t necessarily need to remember every shortcut, simply pick and choose which help you speed up. I found the shortcut to create poly shapes and rectangles during labelling as very useful. Keyboard shortcuts combined with the feature rich app make labelling task slick and smooth. The application also features a task assignment and task process flow using which larger teams can collaborate by assigning tasks to a specific user and updating the current status of task for others to see. CVAT is developed considering the desktop based user interface, which means we need to keep expectations lower while trying to use it on mobile or tablets. You can try the app online right now by navigating to &lt;a href=&quot;https://cvat.org&quot;&gt;cvat.org&lt;/a&gt;
CVAT also features a command line interface which enables you to perform simple CRUD operations on task.&lt;/p&gt;

&lt;h2 id=&quot;data-extraction-upload&quot;&gt;Data Extraction/ Upload&lt;/h2&gt;

&lt;p&gt;A Django app in backend and react UI as frontend, CVAT is quite covered with options to upload data via UI or CLI. App works on a unique task based system, each upload is created as a task in the system. The task can then be further assigned to different users for labelling, quality check, etc. When using the UI to upload data, you don’t need to worry about label formatting because the app takes care of it. CLI based upload requires data to be structured in specific formats before it can be processed. I recommend CLI to perform automated scripts based data upload and UI when actual human is performing the uplaod and labelling task.&lt;/p&gt;

&lt;p&gt;Extraction of data is a very important step which will have to be performed by every team on regular basis. CVAT supports extraction of data in a format by both interfaces i.e. UI and CLI. A user can go to a task and there’s option to extract the data in various supported formats. when trying to extract multiple data points or tasks in CVAT, UI based extraction might seem time consuming . CLI comes to rescue here, extraction of data in any supported format is super simple using CLI. An important thing to note here is CVAT currently doesn’t support bulk extraction or upload of data using UI.&lt;/p&gt;

&lt;p&gt;The dev team also mentiond about datumaro dataset framework which can be used to transform, merge, extract multiple datasets from CVAT. I was not able to get it working and therefore no comments on that.&lt;/p&gt;

&lt;h2 id=&quot;annotations-format-supported&quot;&gt;Annotations Format Supported&lt;/h2&gt;

&lt;p&gt;I am borrowing a table available in CVAT documentation to show the formats supported. It supports all major community defined data label formats. The labels covers the spectrum of classification, obejct detection and segmentation tasks in computer vision.&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Annotation format&lt;/th&gt;
      &lt;th&gt;Import&lt;/th&gt;
      &lt;th&gt;Export&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;a href=&quot;https://github.com/jainds/cvat/blob/develop/cvat/apps/documentation/xml_format.md#annotation&quot;&gt;CVAT for images&lt;/a&gt;&lt;/td&gt;
      &lt;td&gt;X&lt;/td&gt;
      &lt;td&gt;X&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;a href=&quot;https://github.com/jainds/cvat/blob/develop/cvat/apps/documentation/xml_format.md#interpolation&quot;&gt;CVAT for a video&lt;/a&gt;&lt;/td&gt;
      &lt;td&gt;X&lt;/td&gt;
      &lt;td&gt;X&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;a href=&quot;https://github.com/jainds/cvat/blob/develop/datumaro/README.md&quot;&gt;Datumaro&lt;/a&gt;&lt;/td&gt;
      &lt;td&gt; &lt;/td&gt;
      &lt;td&gt;X&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;a href=&quot;http://host.robots.ox.ac.uk/pascal/VOC/&quot;&gt;PASCAL VOC&lt;/a&gt;&lt;/td&gt;
      &lt;td&gt;X&lt;/td&gt;
      &lt;td&gt;X&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Segmentation masks from &lt;a href=&quot;http://host.robots.ox.ac.uk/pascal/VOC/&quot;&gt;PASCAL VOC&lt;/a&gt;&lt;/td&gt;
      &lt;td&gt;X&lt;/td&gt;
      &lt;td&gt;X&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;a href=&quot;https://pjreddie.com/darknet/yolo/&quot;&gt;YOLO&lt;/a&gt;&lt;/td&gt;
      &lt;td&gt;X&lt;/td&gt;
      &lt;td&gt;X&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;a href=&quot;http://cocodataset.org/#format-data&quot;&gt;MS COCO Object Detection&lt;/a&gt;&lt;/td&gt;
      &lt;td&gt;X&lt;/td&gt;
      &lt;td&gt;X&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;a href=&quot;https://www.tensorflow.org/tutorials/load_data/tf_records&quot;&gt;TFrecord&lt;/a&gt;&lt;/td&gt;
      &lt;td&gt;X&lt;/td&gt;
      &lt;td&gt;X&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;a href=&quot;https://motchallenge.net/&quot;&gt;MOT&lt;/a&gt;&lt;/td&gt;
      &lt;td&gt;X&lt;/td&gt;
      &lt;td&gt;X&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;a href=&quot;http://labelme.csail.mit.edu/Release3.0&quot;&gt;LabelMe 3.0&lt;/a&gt;&lt;/td&gt;
      &lt;td&gt;X&lt;/td&gt;
      &lt;td&gt;X&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h2 id=&quot;backup-and-restore&quot;&gt;Backup and Restore&lt;/h2&gt;

&lt;p&gt;All images/videos uploaded are stored in docker volume cvat_data and the respective label data is stored in postgres. Postgres data is stored in docker volume cvat_db. In order to backup the complete app data, you can simply create volume backup for these two volumes in form of .tar files. 
Configuring the said docker volumes to a persistent storage like S3 or azure blob would enable you to setup automated cloud backup for these volumes. 
Restoration is as simple as backup by using docker commands.&lt;/p&gt;

&lt;h2 id=&quot;community&quot;&gt;Community&lt;/h2&gt;

&lt;p&gt;CVAT community is available on &lt;a href=&quot;https://github.com/opencv/cvat&quot;&gt;GitHub&lt;/a&gt; and &lt;a href=&quot;https://gitter.im/opencv-cvat/public&quot;&gt;Gitter&lt;/a&gt;. I have personally found them responding faster on gitter compared to raising issues on github.&lt;/p&gt;</content><author><name></name></author><summary type="html">Introduction</summary></entry><entry><title type="html">Deployment Journey of a Reinforcement Learning Algorithm</title><link href="https://piyush.dev/deployment/2020/07/07/Deploying-RL-Model.html" rel="alternate" type="text/html" title="Deployment Journey of a Reinforcement Learning Algorithm" /><published>2020-07-07T00:00:00-05:00</published><updated>2020-07-07T00:00:00-05:00</updated><id>https://piyush.dev/deployment/2020/07/07/Deploying-RL-Model</id><content type="html" xml:base="https://piyush.dev/deployment/2020/07/07/Deploying-RL-Model.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-07-07-Deploying-RL-Model.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Introduction&quot;&gt;Introduction&lt;a class=&quot;anchor-link&quot; href=&quot;#Introduction&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Our team is working to improve the health and wealth of millions of current customers and acquire more customers in the future. One of the most effective and efficient way to achieve our goal is by getting an app into the millions of people. As it turns out, we already have a wonderful application which is downloaded by more than 3 million users as I write this post.
The mobile application has a carousel portion in the bottom half section of the home page where dynamic banners can be rendered. Each banner is utilized as a form of information, communication medium or an application feature. This is the first page that is seen by all users who successfully register and a portion of them clicking on the banner displayed registering their interest. 
Our team's goal is to increase engagement within the app. The first step was to understand the source of users who were clicking the banners, why are they willing to go into exploring app via banners after registering while others would go on to explore the app via other routes.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Problem-statement&quot;&gt;Problem statement&lt;a class=&quot;anchor-link&quot; href=&quot;#Problem-statement&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;The goal was to increase user engagement within the app by understanding user’s interest in a variety of banners and then leverage the results across the app.&lt;/p&gt;
&lt;p&gt;we didn’t have existing data about user interaction with the app neither did we have enough time at hand to perform that activity. We were also looking at an incoming huge inflow of new users expected in near future due to the planned marketing campaigns. We were essentially looking at a cold start problem to improve engagement since, we would know little about the new users and time to market was a very important factor. We were expected to go live within two weeks duration with a solution to make the best out of data available at hand.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Solution&quot;&gt;Solution&lt;a class=&quot;anchor-link&quot; href=&quot;#Solution&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Bayesian bandits with Thomson sampling ticked all boxes as follows:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;It requires no data or less to start with compared to other options&lt;/li&gt;
&lt;li&gt;It will learn incoming users/data and start recommending banners &lt;/li&gt;
&lt;li&gt;Can work with new banners configured as new arms&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;The next phase of the project was also discussed where we agreed to work on building contextual bandits. In this post, I will be talking more about how we used various tools and technology making deployment possible. I will not be talking about how the recommendation algorithm works and the technology stack used to achieve it.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Deployment&quot;&gt;Deployment&lt;a class=&quot;anchor-link&quot; href=&quot;#Deployment&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/images/copied_from_nb/images/deployment-journey-reinforcement-learning.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The build and deployment part of the project was broken down into two technical stages/phases:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Testing model and documenting results in the pre-prod environment with production data, define the input and the output schema for the model which will be used by the data engineer team to create a streaming pipeline.&lt;/li&gt;
&lt;li&gt;Setup model to consume a live stream of event data, and respond via a REST endpoint with the recommended list of banners for the users&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;The front end of the mobile app is configured for a response time of one second w.r.t to back-end. It meant that the app will try to generate dynamic banners on the user screen based on our recommendations or fall back to static banners if we failed to deliver a response within a second, which added another layer of complexity to the second stage. Our APIs were expected to support a wide range of user load starting from a few hundred requests to millions across the region.&lt;/p&gt;
&lt;p&gt;We could list the deployment infra into three major components:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;A robust build and deployment pipeline&lt;/li&gt;
&lt;li&gt;Automated performance testing&lt;/li&gt;
&lt;li&gt;Production monitoring and alerting&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;Tools&quot;&gt;Tools&lt;a class=&quot;anchor-link&quot; href=&quot;#Tools&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Tools used for the complete setup:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Jenkins&lt;/li&gt;
&lt;li&gt;Artifactory&lt;/li&gt;
&lt;li&gt;Docker&lt;/li&gt;
&lt;li&gt;Aquasec image scanning&lt;/li&gt;
&lt;li&gt;Fortify static code scan
6.. Sonar Nexus open source code scanning&lt;/li&gt;
&lt;li&gt;Kubernetes&lt;/li&gt;
&lt;li&gt;Predator&lt;/li&gt;
&lt;li&gt;Prometheus&lt;/li&gt;
&lt;li&gt;Grafana&lt;/li&gt;
&lt;li&gt;Bitbucket&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Our application solution is a bunch of docker images which consumes/produces content in Kafka topics.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Step-1-&amp;#8212;-Fetching-code-and-checking-for-changes&quot;&gt;Step 1 &amp;#8212; Fetching code and checking for changes&lt;a class=&quot;anchor-link&quot; href=&quot;#Step-1-&amp;#8212;-Fetching-code-and-checking-for-changes&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Our pipeline starts at fetching the code from Bitbucket repository. We store code in the folder structure for the 4 different docker images that are to be built. We check whether a file has been changed before initiating build for the files in that folder. The code in the Jenkins pipeline is as below for one of the folders titled ‘generator’.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#hide_output&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;script&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;GIT_RESULT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;script&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&amp;#39;git diff --quiet HEAD &amp;quot;$(git rev-parse @~1)&amp;quot; -- generator&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;returnStatus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;true&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;GIT RESULT -- $&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{GIT_RESULT}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; -- $&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{params.branchname}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;
              &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Step-2---Fortify&quot;&gt;Step 2 - Fortify&lt;a class=&quot;anchor-link&quot; href=&quot;#Step-2---Fortify&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Next step is to run complete code static security scanning by Fortify&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#hide_output&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sh&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;      echo &amp;quot;==================================================&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;      echo &amp;quot;========--- SAST - Fortify Scan: Start ---========&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;      echo &amp;quot;==================================================&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;      hostname&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;      whoami&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;      ls -ahl&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;      echo &amp;#39;WORKSPACE: &amp;#39; $WORKSPACE&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;      cd $WORKSPACE&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;      pwd&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;      sourceanalyzer -v&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;      sourceanalyzer -b $&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{fortify_app_name}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; -clean&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;      sourceanalyzer -b $&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{fortify_app_name}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; -python-version $&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{python_version}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; -python-path $&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{python_path}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; $&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{fortify_scan_files}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;      sourceanalyzer -b $&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{fortify_app_name}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; -scan -f $&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{fortify_app_name}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;.fpr&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;      fortifyclient -url https://sast.intranet.asia/ssc -authtoken &amp;quot;$&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{fortify_upload_token}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;quot; uploadFPR -file $&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{fortify_app_name}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;.fpr -project $&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{fortify_app_name}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; -version $&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{fortify_app_version}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;     &amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Step-3---Docker&quot;&gt;Step 3 - Docker&lt;a class=&quot;anchor-link&quot; href=&quot;#Step-3---Docker&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;The next step is to build the docker image. We first login to Artifactory before initiating the build as our pip libraries are also pulled from mirrored pip in the Artifactory. I have provided a sample of code on how we achieve this.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#hide_output&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sh&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;                echo $&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{ARTIFACTORY_PASSWORD}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; | docker login -u $&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{ARTIFACTORY_USERNAME}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; --password-stdin docker-registry:8443&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;                cd generator&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;                docker build --file Docker-dev &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;                 --build-arg HTTPS_PROXY=http://ip-address &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;                 --build-arg ARTIFACTORY_USERNAME=$&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{ARTIFACTORY_USERNAME}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;                 --build-arg ARTIFACTORY_PASSWORD=$&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{ARTIFACTORY_PASSWORD}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;                 -t $&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{env.generator_image_latest}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; .&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;                docker tag $&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{env.generator_image_latest}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; $&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{env.generator_image_name}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;                docker push $&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{env.generator_image_latest}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;                docker push $&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{env.generator_image_name}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;                docker logout docker-pcaaicoe.pruregistry.intranet.asia:8443&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;                cd ..&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Step-4---Aquasec&quot;&gt;Step 4 - Aquasec&lt;a class=&quot;anchor-link&quot; href=&quot;#Step-4---Aquasec&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;After pushing an image into Artifactory, the next important and mandatory step to be performed is docker image security scanning.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#hide_output&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sh&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;         echo &amp;quot;==================================================&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;         echo &amp;quot;=============--- OSS - Nexus Scan ---=============&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;         echo &amp;quot;==================================================&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;                docker save -o generator-dev.tar $&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{env.generator_image_latest}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;                &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nexusscan&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;pcaaicoeaipulsenudgesgeneratordev&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;$WORKSPACE&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;build&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;sh&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;                rm -f generator-dev.tar&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;                &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;sh&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;                echo &amp;quot;==================================================&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;                echo &amp;quot;=============--- CSEC - Aquasec Scan ---==========&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;                echo &amp;quot;==================================================&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;aquasecscan&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;$&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{env.generator_image_latest}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The code and image security scanning stages are major milestones to be cleared during the deployment phase. It is important as well as difficult to explain and agree between application security teams about what risks are we willing to take while allowing open source libraries with bugs to go live in our environment.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Step-5-&amp;#8212;-Kubernetes&quot;&gt;Step 5 &amp;#8212; Kubernetes&lt;a class=&quot;anchor-link&quot; href=&quot;#Step-5-&amp;#8212;-Kubernetes&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Now we move on to the stage where we will be able to actually deploy and run our images. In order to deploy our solution, we need a Redis DB and Kafka cluster up and running. We deploy our docker images using the below code:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#hide_output&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sh&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            set +x&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            echo &amp;quot;---- preparing options ----&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            export HTTPS_PROXY=ip-address:8080&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            export KUBE_NAMESPACE=&amp;quot;internal-namespace&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            export KC_OPTS=$&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{KC_OPTS}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;quot; --kubeconfig=$&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{KUBE_CONFIG}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            export KC_OPTS=$&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{KC_OPTS}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;quot; --insecure-skip-tls-verify=true&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            export KC_OPTS=$&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{KC_OPTS}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;quot; --namespace=$&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{KUBE_NAMESPACE}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            &lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            echo &amp;quot;---- prepared options ----&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            echo &amp;quot;---- preparing alias ----&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            alias kc=&amp;quot;kubectl $&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{KC_OPTS}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; $*&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            echo &amp;quot;---- alias prepared ----&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            &lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            echo &amp;quot;---- applying manifest ----&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;   &lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;   &lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;           kc apply -f configmap.yaml&lt;/span&gt;

&lt;span class=&quot;s1&quot;&gt;           if [ $which_app = &amp;quot;generator&amp;quot; ];then&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;             if [ $image_version = &amp;quot;latest&amp;quot; ];then&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;               kc delete deploy ai-pulse-nudges-events-reader||echo&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;             fi&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;             sed -i &amp;quot;s!GENERATOR_VERSION!$image_version!g&amp;quot; &amp;quot;generator.yaml&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;             kc apply -f generator.yaml&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;           fi  &lt;/span&gt;

&lt;span class=&quot;s1&quot;&gt;           if [ $which_app = &amp;quot;aggregator&amp;quot; ];then&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;             if [ $image_version = &amp;quot;latest&amp;quot; ];then&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;               kc delete deploy ai-pulse-nudges-click-counter||echo&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;             fi&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;             sed -i &amp;quot;s!AGGREGATOR_VERSION!$image_version!g&amp;quot; &amp;quot;aggregator.yaml&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;             kc apply -f aggregator.yaml&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;           fi&lt;/span&gt;

&lt;span class=&quot;s1&quot;&gt;           if [ $which_app = &amp;quot;detector&amp;quot; ];then&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;             if [ $image_version = &amp;quot;latest&amp;quot; ];then&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;               kc delete deploy ai-pulse-nudges-engine||echo&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;             fi&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;             sed -i &amp;quot;s!DETECTOR_VERSION!$image_version!g&amp;quot; &amp;quot;detector.yaml&amp;quot; &lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;             kc apply -f detector.yaml&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;           fi&lt;/span&gt;

&lt;span class=&quot;s1&quot;&gt;           if [ $which_app = &amp;quot;restapi&amp;quot; ];then&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;             if [ $image_version = &amp;quot;latest&amp;quot; ];then&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;               kc delete deploy ai-pulse-nudges-restapi||echo&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;                fi&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;             sed -i &amp;quot;s!REST_VERSION!$image_version!g&amp;quot; &amp;quot;restapi.yaml&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;             kc apply -f restapi.yaml&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;                    fi&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            if [ $which_app = &amp;quot;all&amp;quot; ];then&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;             if [ $image_version = &amp;quot;latest&amp;quot; ];then&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;             kc delete deploy ai-pulse-nudges-events-reader||echo&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;             kc delete deploy ai-pulse-nudges-click-counter||echo&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;             kc delete deploy ai-pulse-nudges-engine||echo&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;             kc delete deploy ai-pulse-nudges-restapi||echo&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;             fi&lt;/span&gt;

&lt;span class=&quot;s1&quot;&gt;             sed -i &amp;quot;s!GENERATOR_VERSION!$image_version!g&amp;quot; &amp;quot;generator.yaml&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;             sed -i &amp;quot;s!AGGREGATOR_VERSION!$image_version!g&amp;quot; &amp;quot;aggregator.yaml&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;             sed -i &amp;quot;s!DETECTOR_VERSION!$image_version!g&amp;quot; &amp;quot;detector.yaml&amp;quot; &lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;             sed -i &amp;quot;s!REST_VERSION!$image_version!g&amp;quot; &amp;quot;restapi.yaml&amp;quot;&lt;/span&gt;

&lt;span class=&quot;s1&quot;&gt;             kc apply -f generator.yaml&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;             kc apply -f aggregator.yaml&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;             kc apply -f detector.yaml&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;             kc apply -f restapi.yaml&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;                    fi&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;   &lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;   &lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;   &lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            echo &amp;quot;---- manifest applied ----&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            echo &amp;quot;---- checking result ----&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            &lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            echo &amp;quot; &amp;gt;&amp;gt; Deployments &amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            kc get deployments&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            &lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            echo &amp;quot; &amp;gt;&amp;gt; Services&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            kc get svc&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            &lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            echo &amp;quot; &amp;gt;&amp;gt; Ingress&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            kc get ingress&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            &lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            echo &amp;quot; &amp;gt;&amp;gt; Pods&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            kc get pods&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            &lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            echo &amp;quot;---- Done ----&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;          &amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Step-6-&amp;#8212;-Performance-test&quot;&gt;Step 6 &amp;#8212; Performance test&lt;a class=&quot;anchor-link&quot; href=&quot;#Step-6-&amp;#8212;-Performance-test&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;We deploy Predator — the tool which we use for performance test.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#hide_output&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sh&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            set +x&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            echo &amp;quot;---- preparing options ----&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            export HTTPS_PROXY=ip-address:8080&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            export KUBE_NAMESPACE=&amp;quot;internal-namespace&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            export KC_OPTS=$&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{KC_OPTS}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;quot; --kubeconfig=$&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{KUBE_CONFIG}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            export KC_OPTS=$&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{KC_OPTS}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;quot; --insecure-skip-tls-verify=true&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            export KC_OPTS=$&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{KC_OPTS}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;quot; --namespace=$&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{KUBE_NAMESPACE}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            &lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            echo &amp;quot;---- prepared options ----&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            echo &amp;quot;---- preparing alias ----&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            alias kc=&amp;quot;kubectl $&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{KC_OPTS}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; $*&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            echo &amp;quot;---- alias prepared ----&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            &lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            echo &amp;quot;---- applying manifest ----&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;   &lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;           kc get deploy|grep predator|awk &amp;#39;{print $1 }&amp;#39; || echo&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;           kc get deploy|grep predator|awk &amp;#39;{print $1 }&amp;#39;|xargs kc delete deploy || echo&lt;/span&gt;

&lt;span class=&quot;s1&quot;&gt;           for i in `seq $replica_count`&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;           do&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;             echo $i&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;             cp -rf predator/predator.yaml tmp.yaml&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;             sed -i &amp;quot;s!REPLICA_NO!$i&amp;quot;&amp;quot;!g&amp;quot; &amp;quot;tmp.yaml&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;             kc apply -f tmp.yaml&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;           done  &lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;   &lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;   &lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            # kc apply -f predator/predator.yaml&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            &lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            echo &amp;quot;---- manifest applied ----&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            echo &amp;quot;---- checking result ----&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            &lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            echo &amp;quot; &amp;gt;&amp;gt; Deployments &amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            kc get deployments&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            &lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            echo &amp;quot; &amp;gt;&amp;gt; Services&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            kc get svc&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            &lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            echo &amp;quot; &amp;gt;&amp;gt; Ingress&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            kc get ingress&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            &lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            echo &amp;quot; &amp;gt;&amp;gt; Pods&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            kc get pods&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            &lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;            echo &amp;quot;---- Done ----&amp;quot;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;          &amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Predator is an amazing tool that enables us to leverage existing Kubernetes infra for an unlimited number of users for testing. Read more about the tool here: &lt;a href=&quot;https://medium.com/zooz-engineering/by-niv-lipetz-software-engineer-zooz-b5928da0b7a8&quot;&gt;https://medium.com/zooz-engineering/by-niv-lipetz-software-engineer-zooz-b5928da0b7a8&lt;/a&gt;
We leverage the existing enterprise Prometheus and Grafana set up to monitor the application pods.&lt;/p&gt;
&lt;h2 id=&quot;Lessons-learned-for-next-time:&quot;&gt;Lessons learned for next time:&lt;a class=&quot;anchor-link&quot; href=&quot;#Lessons-learned-for-next-time:&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;We started writing the pipeline code from scratch, whereas it would have helped save time if an advanced hello world type of empty pipeline existed, which could be used as a template structure. It would have enabled us to know what credentials and access were required at what stage.&lt;/li&gt;
&lt;li&gt;There were many credentials and access that were required to get the pipeline up and running. It would be a time and effort savior if we have one master service id created and assigned to a pipeline which can then be used across all tools in the organization.&lt;/li&gt;
&lt;li&gt;It is very difficult to build a machine learning model, and real-time streaming data was an additional complexity, but productionizing that model with streaming data is many folds difficult.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;Contributors&quot;&gt;Contributors&lt;a class=&quot;anchor-link&quot; href=&quot;#Contributors&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Glenn Bayne, Tien Nguyet Long, John Yue, Zeldon Tay （郑育忠), Steven Chau , Denys Pang , Philipp Gschoepf , Syam Bandi , Uma Maheshwari, Michael Natusch&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://piyush.dev/images/deployment-journey-reinforcement-learning.png" /><media:content medium="image" url="https://piyush.dev/images/deployment-journey-reinforcement-learning.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry></feed>